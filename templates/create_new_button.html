<button class="btn btn-link nav-link text-dark create-item"
    data-model="{{ model.model_name }}">
    {{ model.frontend_table_name }}
</button>
<script>
    document.addEventListener("DOMContentLoaded", function () {
    // Find all "Create New" buttons
    document.querySelectorAll(".create-item").forEach(button => {
        button.addEventListener("click", function (event) {
            event.preventDefault(); // Prevent any unwanted default behavior
            
            const modelName = this.dataset.model; // Get model name from data attribute
            console.log(`Fetching create form for model: ${modelName}`);

            // Fetch modal content from the server
            fetch("/get-create-new-form", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ model_name: modelName }) // Send model name in JSON format
            })
            .then(response => {
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                return response.text();
            })
            .then(html => {
                const modalContainer = document.getElementById("createNewModalContainer");
                modalContainer.innerHTML = html; // Inject modal HTML

                // Ensure Bootstrap properly initializes the modal
                setTimeout(() => {
                    const modalElement = document.getElementById("createNewModal");
                    if (modalElement) {
                        const modalInstance = new bootstrap.Modal(modalElement);
                        modalInstance.show();
                    }
                }, 100);
            })
            .catch(error => {
                console.error("Error loading modal:", error);
                alert("Failed to load the form. Please try again.");
            });
        });
    });
});

</script>